<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="keywords"
          content="admin, dashboard, bootstrap, template, flat, modern, theme, responsive, fluid, retina, backend, html5, css, css3">
    <meta name="description" content="股票金融风险预测平台">
    <meta name="author" content="ThemeBucket">
    <link rel="shortcut icon" href="../static/hpcomputing/images/favicon.ico"
          th:href="@{/hpcomputing/images/invoice-logo.jpg}" type="image/png">
    <title>股票金融风险预测平台</title>

    <!--pickers css-->
    <link rel="stylesheet" type="text/css"
          href="../static/hpcomputing/plugins/bootstrap-datepicker/css/datepicker-custom.css"
          th:href="@{/hpcomputing/plugins/bootstrap-datepicker/css/datepicker-custom.css}"/>

    <!--slider css-->
    <link href="../static/hpcomputing/css/jquery-ui-1.10.3.css" th:href="@{/hpcomputing/css/jquery-ui-1.10.3.css}"/>
    <!--dynamic table-->
    <link href="../static/hpcomputing/plugins/advanced-datatable/css/demo_page.css"  th:href="@{/hpcomputing/plugins/advanced-datatable/css/demo_page.css}"  rel="stylesheet"/>
    <link href="../static/hpcomputing/plugins/advanced-datatable/css/demo_table.css" th:href="@{/hpcomputing/plugins/advanced-datatable/css/demo_table.css}" rel="stylesheet"/>
    <link href="../static/hpcomputing/plugins/data-tables/DT_bootstrap.css" th:href="@{/hpcomputing/plugins/data-tables/DT_bootstrap.css}"/>

    <!--common-->
    <link href="../static/hpcomputing/css/style.css" th:href="@{/hpcomputing/css/style.css}" rel="stylesheet">
    <link href="../static/hpcomputing/css/style-responsive.css" th:href="@{/hpcomputing/css/style-responsive.css}" rel="stylesheet">
    <link href="../static/hpcomputing/css/mystyle.css" th:href="@{/hpcomputing/css/mystyle.css}" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script th:src="@{/hpcomputing/js/html5shiv.js}"></script>
    <script th:src="@{/hpcomputing/js/respond.min.js}"></script>
    <![endif]-->
    <!--##################################3##########################################-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

</head>

<body class="sticky-header">
<section>
    <!-- left side start-->
    <div class="left-side sticky-left-side"  th:include="left_side_template :: leftside"></div>
     <!--left side end-->

    <!-- main content start-->
    <div class="main-content">

        <!-- header section start-->
        <div class="header-section" style="border-bottom: rgba(0,0,0,0.39) solid 1px;">
            <!--toggle button start-->
            <a class="toggle-btn"><i class="fa fa-bars"></i></a>
            <!--toggle button end-->
            <!--title start-->
            <div style="width: 80%;margin-top: 15px;text-align: center;">
                <span style="font-size:30px;margin-left: 200px;">股票金融风险预测平台</span>
                <div id="click" style="float:right;"></div>
            </div>
            <!--title end-->
        </div>
        <!-- header section end-->

        <!--body wrapper start-->
        <div class="wrapper">

            <!--预测参数 start-->
            <div class="row">
                <div class="col-md-12">
                    <!--param setting start-->
                    <section class="panel">
                        <header class="panel-heading">
                            预测参数设置
                            <span class="tools pull-right">
                                <a class="fa fa-chevron-down" href="javascript:;"></a>
                            </span>
                        </header>
                        <div class="panel-body">
                            <div class="panel-body">
                                <div class="col-md-7">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="row">
                                                <div class="col-md-5"
                                                     style="position: relative;transform: translateY(20%);text-align: right;">
                                                    <label>股票数量:</label>
                                                </div>
                                                <div class="col-md-7">
                                                    <input th:value="${stock_size}" type="text" id="amount" class="form-control">
                                                    <div id="slider-range-max"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <div class="col-md-5"
                                                     style="position: relative;transform: translateY(20%);text-align: right;">
                                                    <label>起始日期:</label>
                                                </div>
                                                <div class="col-md-7">
                                                    <input th:value="${start_date}" class="form-control default-date-picker" size="16"
                                                           type="text" value="" readonly/>
                                                </div>
                                            </div>
                                            <div class="row next_param">
                                                <div class="col-md-5"
                                                     style="position: relative;transform: translateY(20%);text-align: right;">
                                                    <label>结束日期:</label>
                                                </div>
                                                <div class="col-md-7">
                                                    <input class="form-control default-date-picker" size="16"
                                                           type="text" th:value="${end_date}" readonly/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <label>聚类族数:</label>
                                                </div>
                                                <div class="col-md-7">
                                                    <input type="text" class="form-control"
                                                           placeholder="150"
                                                           th:value="${cluster_size}">
                                                </div>
                                            </div>
                                            <div class="row next_param">
                                                <div class="col-md-5">
                                                    <label>预测天数:</label>
                                                </div>
                                                <div class="col-md-7">
                                                    <input type="text" class="form-control"
                                                           placeholder="100"
                                                           th:value="${predict_dates}">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-5" style="margin-top: 20px;">
                                    <button class="btn btn-primary btn-lg" type="button">开始预测</button>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!--param setting end-->
                </div>
            </div>
            <!--预测参数 end-->

            <!--最优组合结果 start-->
            <div class="row">
                <div class="col-md-4">
                    <!--more statistics box start-->
                    <div class="panel" style="background-color: #000000;height: 530px;">
                        <div class="panel-body" >
                            <p style="padding-left:5px;color: #ffffff;font-size: 16px;">最优组合结果</p>
                            <section class="panel">
                                <div class="panel-body stockListPanel">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th><span class="label label-info label-mini"></span></th>
                                            <th>聚类类别</th>
                                            <th>股票代码</th>
                                            <th>股票名称</th>
                                        </tr>
                                        </thead>
                                        <tbody id="tbzuhe">
                                        <tr th:each="zuhe,iterStat:${zuheList}"
                                        th:id="${zuhe.name}">
                                            <td></td>
                                            <td th:text="|第${zuhe.classId}聚类|">第i类</td>
                                            <td th:text="${zuhe.id}">第i类</td>
                                            <td th:text="${zuhe.name}">第i类</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>

                            <div id="echart-piecchart"
                                 style="min-width:200px;height:200px;margin-top: 20px;" ></div>

                        </div>
                    </div>
                    <!--more statistics box end-->
                </div>
                <div class="col-md-8">
                    <div class="panel" style="background-color: rgba(0,0,0,0.45);">
                        <div class="panel-body">
                            <div id="echarts-div" style="min-width:420px;height:500px;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!--最优组合结果 end-->

            <!--所有股票聚类结果 start-->
            <div class="row">
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-sm-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    所有聚类结果
                                    <span class="tools pull-right">
                <a href="javascript:;" class="fa fa-chevron-down"></a>
             </span>
                                </header>
                                <div class="panel-body">
                                    <div class="adv-table">
                                        <table class="display table table-bordered table-striped" id="dynamic-table">
                                            <thead>
                                            <tr>
                                                <th>聚类类别</th>
                                                <th>股票代码</th>
                                                <th>股票名称</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="zuhe,iterStock:${clusterZuheList}"
                                                th:id="${zuhe.id}">
                                                <td th:text="|第${zuhe.classId}聚类|">第i类</td>
                                                <td th:text="${zuhe.id}">代码</td>
                                                <td th:text="${zuhe.name}">名称</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="panel">
                        <div class="panel">
                            <div class="panel-body">
                                <div id="echarts-div2" style="min-width:500px;height:500px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!--所有股票聚类结果 end-->
        </div>
        <!--body wrapper end-->
        <!--footer section start-->
        <footer th:include="footer_template :: myfooter"></footer>
        <!--footer section end-->
    </div>
    <!-- main content end-->
</section>


<!-- Placed js at the end of the document so the pages load faster -->
<script src="../static/hpcomputing/js/jquery-1.10.2.min.js" th:src="@{/hpcomputing/js/jquery-1.10.2.min.js}"></script>
<script src="../static/hpcomputing/js/jquery-ui-1.9.2.custom.min.js" th:src="@{/hpcomputing/js/jquery-ui-1.9.2.custom.min.js}"></script>
<script src="../static/hpcomputing/js/jquery-migrate-1.2.1.min.js" th:src="@{/hpcomputing/js/jquery-migrate-1.2.1.min.js}"></script>
<script src="../static/hpcomputing/js/bootstrap.min.js" th:src="@{/hpcomputing/js/bootstrap.min.js}"></script>
<!--<script src="js/js/modernizr.min.js"></script>-->
<script src="../static/hpcomputing/js/bootstrap.min.js" th:src="@{/hpcomputing/js/jquery.nicescroll.js}"></script>

<!--common scripts for all pages-->
<script src="../static/hpcomputing/js/scripts.js"  th:src="@{/hpcomputing/js/scripts.js}"></script>
<!--pickers plugins-->
<script src="../static/hpcomputing/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"  th:src="@{/hpcomputing/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js}"></script>
<!--pickers initialization-->
<!--<script src="../static/js/pickers-init.js" th:src="@{js/pickers-init.js}"></script>-->

<!--slider initialization-->
<script src="../static/hpcomputing/js/myjsfile.js" th:src="@{js/myjsfile.js}"></script>

<!-- DATA TABLE SCRIPTS -->
<script src="../static/hpcomputing/dataTables/jquery.dataTables.js"
        th:src="@{/dataTables/jquery.dataTables.js}"></script>
<script src="../static/hpcomputing/dataTables/dataTables.bootstrap.js"
        th:src="@{/dataTables/dataTables.bootstrap.js}"></script>

<!-- echarts stock-->
<script src="../static/hpcomputing/js/echarts/echarts.min.js" th:src="@{/hpcomputing/js/echarts/echarts.min.js}"></script>
<script src="../static/hpcomputing/js/echarts/dark.js" th:src="@{/hpcomputing/js/echarts/dark.js}"></script>
<script src="../static/hpcomputing/js/echarts/echarts-init.js" th:src="@{/hpcomputing/js/echarts/echarts-init.js}"></script>


<!--slider initialization-->
<!--<script th:inline="javascript" src="../static/js/inline_js.js" th:src="@{js/inline_js.js}"></script>-->
<script th:inline="javascript">
    /*<![CDATA[*/
    var size = /*[[${stock_size}]]*/ 2;
    var all_stock_size = /*[[${all_stock_size}]]*/ 100;
    //alert("size is "+size);
    setStockSize(all_stock_size,size);
    /*]]>*/
</script>

<script th:inline="javascript">
    /*<![CDATA[*/
    // 最优组合的echart 初始化echarts实例
    var zuheList = /*[[${zuheList}]]*/ 2;
    //alert(zuheList[0].id+":"+zuheList[0].name);
    var myChart = echarts.init(document.getElementById('echarts-div'),"dark");
    //    var xdata = ["2017/12/18","2017/12/20","2018/1/2",
    //        "2018/1/5","2018/1/8","2018/1/10","2018/1/22","2018/1/22","2018/1/23","2018/1/26","2018/1/28"];
    //var bestchartdata =[[5, 20, 36, 10, 10, 20], [-5, 50, 26, 20, -10, 50]];
    var xdata = /*[[${xdata}]]*/ 2;
    var model = /*[[${model}]]*/ 2;
    var urlStr = "/getStockDataByModelAndStock?modelName="+model+"&stockName="+zuheList[0].name;
    $.get(urlStr,function(data,status){
        //alert("数据: " + data + "\n状态: " + status);
        var bestdata = getDataTransfer(data);
        setBestChart(myChart,bestdata,xdata,zuheList[0].id+":"+zuheList[0].name);

    });
    //设置table和聚类饼图的相应颜色对应
    setBestResultColor();
    for (var i =0; i<zuheList.length; i++){
        (function(){
            var zuhe = zuheList[i];
            $("#"+zuhe.name).click(function(){
                // 动作触发后执行的代码!!
                var urlStr = "/getStockDataByModelAndStock?modelName="+model+"&stockName="+zuhe.name;
                $.get(urlStr,function(data,status){
                    //alert("数据: " + data + "\n状态: " + status);
                    var bestdata = getDataTransfer(data);
                    setBestChart(myChart,bestdata,xdata,zuhe.id+":"+zuhe.name);

                });
            });
        })();
    }

    /*所有聚类的图表 start*/
    var clusterZuheList = /*[[${clusterZuheList}]]*/ 2;
    var myChart2 = echarts.init(document.getElementById('echarts-div2'));

    //因为所有股票列表自动排列的原因，此处显示最后一支股票
    var allZuhe = clusterZuheList[0];
     urlStr = "/getStockDataByModelAndStock?modelName="+model
         +"&stockName="+allZuhe.name;

    $.get(urlStr,function(data,status){
        //alert("数据: " + data + "\n状态: " + status);
        var bestdata = getDataTransfer(data);
        setBestChart(myChart2,bestdata,xdata,allZuhe.id+":"+allZuhe.name);

    });

    for (var i =0; i<clusterZuheList.length; i++){
        (function(){
            var zuhe = clusterZuheList[i];
            $("#"+zuhe.id).click(function(){
                // 动作触发后执行的代码!!
                var urlStr = "/getStockDataByModelAndStock?modelName="+model+"&stockName="+zuhe.name;
                $.get(urlStr,function(data,status){
                    //alert("数据: " + data + "\n状态: " + status);
                    var bestdata = getDataTransfer(data);
                    setBestChart(myChart2,bestdata,xdata,zuhe.id+":"+zuhe.name);
                });
            });
        })();
    }
    /*]]>*/
</script>
<script th:inline="javascript">
    /*<![CDATA[*/
    var piePartList = /*[[${pieChartsParamList}]]*/ 2;
    //alert(piePartList);
    var piechartdata =[];
    for (var i=0;i<piePartList.length;i++){
        var temp = {value:piePartList[i].value,name:piePartList[i].partName};
        piechartdata[i] = temp;
    }
    /*最优组合的图表 piecahrt start*/
//    var data = [
//        {value:335, name:'第一聚类'},
//        {value:310, name:'第二聚类'}
//    ];
    setPieChart(piechartdata);
    /*]]>*/
</script>
<script >
    $("#model-page").addClass("active")
</script>
</body>
</html>
